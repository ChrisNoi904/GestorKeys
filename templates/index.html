{% extends "layout.html" %}

{% block title %}Consulta CUIT{% endblock %}

{% block content %}
    <h2>Consulta CUIT y Padrón AFIP</h2>
    
    <form method="POST">
        <div class="form-group">
            <label for="cuit_consulta">CUIT a consultar:</label>
            <input type="text" id="cuit_consulta" name="cuit_consulta" required value="{{ cuit_consultado if cuit_consultado else '' }}">
        </div>
        <button type="submit" class="btn btn-primary">Consultar AFIP</button>
        {% if cuit_consultado %}
            <button type="submit" name="guardar_cliente" value="1" class="btn btn-success">Guardar Cliente (DB)</button>
        {% endif %}
    </form>
    
    <hr>
    
    {% if error_message %}
        <p class="flash error">❌ {{ error_message }}</p>
    {% elif resultado_html %}
        <div style="background-color: #e8eaf6; padding: 15px; border-radius: 4px;">
            {{ resultado_html | safe }}
        </div>
        {% if razon_social %}
            <p style="margin-top: 10px;">**Razón Social (para copiar):** <input type="text" value="{{ razon_social }}" readonly style="width: 50%; font-weight: bold;"></p>
        {% endif %}
    {% endif %}

    <h3 style="margin-top: 30px;">Carga Inicial de Datos (Opcional)</h3>
    <form method="POST">
        <button type="submit" name="carga_inicial" value="1" class="btn btn-info" onclick="return confirm('¿Está seguro de cargar datos desde el archivo claves.xlsx? Esto solo debe hacerse una vez para migrar datos.')">Migrar Clientes y Claves desde Excel (Solo Inicial)</button>
        <p style="font-size: 0.8em; margin-top: 5px;">Asegúrese de que el archivo 'claves.xlsx' esté en la misma carpeta que app.py para la migración.</p>
    </form>
{% endblock %}